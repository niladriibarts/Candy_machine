<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css">

{% assign total_cards = section.blocks.size %}

{% style %}
.shop-category {
  padding: 60px 0;
  position: relative;
}

.shop-category__heading {
  text-align: center;
  margin-bottom: 40px;
}

.shop-category__heading h2 {
  font-size: 40px;
  font-weight: 600;
  line-height: 85%;
  text-transform: uppercase;
}

/* .category-slider {
  visibility: hidden;
} */

.category-slider.slick-initialized {
  visibility: visible;
}

.category-slider.no-slider {
  display: flex;
  justify-content: center;
  gap: 20px;
  visibility: visible;
}

.category-slide {
  margin: 0 10px;
  border-radius: 20px;
  border: 1px solid #DFDFDF;
  transition: box-shadow 0.3s ease;
}

.category-slide:hover {
  box-shadow: 0 28px 28px #f8518b2b;
}

.category-card {
  width: 300px;
  height: 320px;
  background: #fff;
  border-radius: 20px;
  overflow: hidden;
  text-align: center;
  transition: transform 0.3s ease;
  margin: 0 auto;
}

.category-card:hover {
  transform: translateY(-6px);
}

.category-card img {
  width: 100%;
  height: 260px;
  object-fit: cover;
  border-radius: 16px;
}

.category-card h3 {
  font-size: 16px;
  font-weight: 600;
  color: #2F89C2;
  padding: 12px;
  text-transform: uppercase;
}

.category-slider .slick-prev,
.category-slider .slick-next {
  width: 50px;
  height: 50px;
  background: #F93CB7;
  border-radius: 50%;
  z-index: 10;
  top: 40%;
}
.category-slider button.slick-arrow:hover {
    background: #F93CB7;
}
.category-slider .slick-prev:before,
.category-slider .slick-next:before {
  display: none;
}

.category-slider .slick-prev {
  left: -28px;
}

.category-slider .slick-next {
  right: -28px;
}

@media (max-width: 1024px) {
  .category-card {
    width: 260px;
    height: 300px;
  }
}

@media (max-width: 768px) {
  .shop-category__heading h2 {
    font-size: 28px;
  }

  .category-card {
    width: 220px;
    height: 280px;
  }

  .category-slider .slick-prev {
    left: -18px;
    width: 50px;
    height: 50px;
  }

  .category-slider .slick-next {
    right: -18px;
    width: 50px;
    height: 50px;
  }
}
{% endstyle %}

<section class="shop-category">
  <div class="page-width">
  <div class="ib-custom-container">

    {% if section.settings.heading != blank %}
      <div class="shop-category__heading">
        <h2>{{ section.settings.heading }}</h2>
      </div>
    {% endif %}

    <div class="category-slider{% if total_cards <= 4 %} no-slider{% endif %}">
      {% for block in section.blocks %}
        <div class="category-slide" {{ block.shopify_attributes }}>
          <a href="{{ block.settings.link }}" class="category-card">
            {% if block.settings.image %}
              <img
                src="{{ block.settings.image | image_url }}"
                width="300"
                height="300"
                alt="{{ block.settings.title | escape }}"
                loading="lazy">
            {% endif %}
            {% if block.settings.title %}
              <h3>{{ block.settings.title }}</h3>
            {% endif %}
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
  </div>
</section>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Slick JS -->
<script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  var totalCards = {{ total_cards }};
  var $slider = $('.category-slider');

  if (totalCards > 4 && $slider.length) {
    $slider.slick({
      slidesToShow: 4,
      slidesToScroll: 1,
      arrows: true,
      dots: false,
      infinite: false,
      prevArrow: `
        <button type="button" class="slick-prev" aria-label="Previous">
          <svg
            width="11"
            height="16"
            viewBox="0 0 11 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path d="M9.09578 0.00019598C9.33204 -0.00418485 9.56381 0.0649744 9.75904 0.198104C9.95426 0.331233 10.1033 0.52175 10.1855 0.743291C10.2677 0.964831 10.279 1.20644 10.2178 1.43469C10.1567 1.66293 10.0261 1.86653 9.84413 2.0173L2.88104 7.97829L9.84843 13.9393C9.97572 14.0321 10.0824 14.1502 10.1617 14.2863C10.241 14.4224 10.2913 14.5735 10.3093 14.73C10.3273 14.8864 10.3127 15.045 10.2664 15.1955C10.22 15.3461 10.143 15.4854 10.0401 15.6047C9.93722 15.7239 9.81073 15.8206 9.66862 15.8885C9.5265 15.9565 9.37185 15.9942 9.21442 15.9994C9.05698 16.0046 8.90019 15.977 8.75392 15.9186C8.60766 15.8601 8.47511 15.7719 8.36463 15.6596L0.399441 8.85137C0.274175 8.74437 0.173594 8.61149 0.104627 8.46188C0.0356588 8.31227 -5.53131e-05 8.14948 -5.53131e-05 7.98474C-5.53131e-05 7.82 0.0356588 7.65722 0.104627 7.50761C0.173594 7.358 0.274175 7.22512 0.399441 7.11812L8.36463 0.288353C8.56648 0.108656 8.82561 0.00652844 9.09578 0.00019598Z" fill="white" />
          </svg>
        </button>
      `,

      nextArrow: `
        <button type="button" class="slick-next" aria-label="Next">
          <svg
            width="11"
            height="16"
            viewBox="0 0 11 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path d="M1.22099 0.00019598C0.984737 -0.00418485 0.752961 0.0649744 0.557737 0.198104C0.362514 0.331233 0.213496 0.52175 0.131304 0.743291C0.0491124 0.964831 0.0378104 1.20644 0.0989631 1.43469C0.160116 1.66293 0.290699 1.86653 0.472643 2.0173L7.43574 7.97829L0.468342 13.9393C0.341054 14.0321 0.234383 14.1502 0.15506 14.2863C0.0757369 14.4224 0.0254846 14.5735 0.00747437 14.73C-0.0105359 14.8864 0.0040872 15.045 0.0504204 15.1955C0.0967536 15.3461 0.173791 15.4854 0.276671 15.6047C0.379551 15.7239 0.506039 15.8206 0.648153 15.8885C0.790268 15.9565 0.944922 15.9942 1.10236 15.9994C1.25979 16.0046 1.41659 15.977 1.56285 15.9186C1.70911 15.8601 1.84166 15.7719 1.95214 15.6596L9.91733 8.85137C10.0426 8.74437 10.1432 8.61149 10.2121 8.46188C10.2811 8.31227 10.3168 8.14948 10.3168 7.98474C10.3168 7.82 10.2811 7.65722 10.2121 7.50761C10.1432 7.358 10.0426 7.22512 9.91733 7.11812L1.95214 0.288353C1.75029 0.108656 1.49116 0.00652844 1.22099 0.00019598Z" fill="white" />
          </svg>
        </button>
      `,
      responsive: [
        { breakpoint: 1024, settings: { slidesToShow: 3 } },
        { breakpoint: 768, settings: { slidesToShow: 2 } },
        { breakpoint: 480, settings: { slidesToShow: 1 } }
      ]
    });
  }
});
</script>

{% schema %}
{
  "name": "Shop By Category Slider",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Shop By Category"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Category Image" },
        { "type": "text", "id": "title", "label": "Category Title" },
        { "type": "url", "id": "link", "label": "Category Link" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Shop By Category Slider",
      "blocks": [
        { "type": "category" },
        { "type": "category" },
        { "type": "category" },
        { "type": "category" }
      ]
    }
  ]
}
{% endschema %}
